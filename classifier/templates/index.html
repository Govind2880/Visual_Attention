<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß† AI Text Sentiment Analyzer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    * { font-family: 'Inter', sans-serif; }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      background-size: 200% 200%;
      animation: gradientShift 6s ease infinite;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .glass-card {
      backdrop-filter: blur(16px);
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    .attention-word {
      display: inline-block;
      padding: 4px 8px;
      margin: 2px;
      border-radius: 6px;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .attention-word:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .pulse-dot {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
      70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
      100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
    }
    
    .typing-animation {
      border-right: 2px solid #667eea;
      animation: blink 1s infinite;
    }
    
    @keyframes blink {
      50% { border-color: transparent; }
    }
    
    .progress-ring {
      transition: stroke-dashoffset 0.5s ease-in-out;
    }
    
    .model-info {
      background: linear-gradient(45deg, #f093fb, #f5576c);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .floating-stats {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
    }
    
    @media (max-width: 768px) {
      .floating-stats { display: none; }
    }
    
    .sentiment-emoji {
      font-size: 3rem;
      animation: bounce 1s ease-in-out;
    }
    
    @keyframes bounce {
      0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
      40%, 43% { transform: translate3d(0,-30px,0); }
      70% { transform: translate3d(0,-15px,0); }
      90% { transform: translate3d(0,-4px,0); }
    }
  </style>
</head>
<body class="gradient-bg min-h-screen">
  <!-- Floating Stats -->
  <div class="floating-stats">
    <div class="glass-card rounded-xl p-4 text-center">
      <div class="text-sm text-gray-600 mb-1">Model Stats</div>
      <div class="text-xs text-gray-500">Accuracy: 91.2%</div>
      <div class="text-xs text-gray-500">Parameters: 66M</div>
      <div class="pulse-dot w-3 h-3 bg-green-500 rounded-full mx-auto mt-2"></div>
    </div>
  </div>

  <!-- Header -->
  <div class="container mx-auto px-4 py-8 text-center text-white">
    <div class="mb-4">
      <h1 class="text-5xl font-bold mb-2 typing-animation inline-block">
        üß† AI Sentiment Analyzer
      </h1>
    </div>
    <p class="text-xl opacity-90 mb-2">Powered by Fine-tuned DistilBERT</p>
    <div class="model-info text-lg font-semibold">
      üéØ 91.2% Accuracy ‚Ä¢ ‚ö° Real-time Analysis ‚Ä¢ üîç Attention Visualization
    </div>
  </div>

  <div class="container mx-auto px-4 pb-8 max-w-6xl">
    <!-- Main Input Card -->
    <div class="glass-card rounded-2xl p-8 mb-8 shadow-2xl">
      <div class="flex items-center mb-6">
        <i class="fas fa-brain text-3xl text-blue-600 mr-4"></i>
        <h2 class="text-3xl font-bold text-gray-800">Analyze Your Text</h2>
      </div>
      
      <form method="POST" id="classifyForm" class="space-y-6">
        {% csrf_token %}
        <div class="relative">
          <textarea 
            name="user_input" 
            id="textInput"
            rows="4" 
            class="w-full p-6 border-2 border-gray-200 rounded-xl text-lg resize-none focus:border-blue-500 focus:ring-4 focus:ring-blue-200 transition-all duration-300"
            placeholder="‚ú® Enter your text here... Try: 'This movie was absolutely incredible!'"
            maxlength="500"
            required>{{ text|default:"" }}</textarea>
          <div class="absolute bottom-4 right-4 text-sm text-gray-400">
            <span id="charCount">0</span>/500
          </div>
        </div>
        
        <!-- Quick Examples -->
        <div class="flex flex-wrap gap-2 mb-4">
          <button type="button" class="example-btn px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm hover:bg-green-200 transition-colors" 
                  data-text="This movie was absolutely fantastic and amazing!">
            üòç Positive Example
          </button>
          <button type="button" class="example-btn px-4 py-2 bg-red-100 text-red-800 rounded-full text-sm hover:bg-red-200 transition-colors"
                  data-text="This was terrible, boring and a complete waste of time.">
            üòû Negative Example  
          </button>
          <button type="button" class="example-btn px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200 transition-colors"
                  data-text="The weather today is quite nice for a walk.">
            üòê Neutral Example
          </button>
        </div>
        
        <button 
          type="submit" 
          id="submitBtn"
          class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-xl text-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
          <span id="btnText">
            <i class="fas fa-magic mr-2"></i>
            Analyze Sentiment
          </span>
          <span id="btnLoading" class="hidden">
            <i class="fas fa-spinner fa-spin mr-2"></i>
            Analyzing...
          </span>
        </button>
      </form>

      {% if error %}
      <div class="mt-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-xl animate-pulse">
        <i class="fas fa-exclamation-triangle mr-2"></i>
        <strong>Error:</strong> {{ error }}
      </div>
      {% endif %}
    </div>

    <!-- Results Section -->
    {% if success and prediction %}
    <div class="grid lg:grid-cols-3 gap-8 mb-8">
      <!-- Main Result -->
      <div class="lg:col-span-2">
        <div class="glass-card rounded-2xl p-8 shadow-2xl">
          <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
            <i class="fas fa-chart-line mr-3 text-blue-600"></i>
            Analysis Results
          </h2>
          
          <!-- Sentiment Result with Animation -->
          <div class="text-center mb-8 p-8 rounded-xl {% if prediction == 'Positive' %}bg-gradient-to-r from-green-100 to-green-50 border-2 border-green-300{% else %}bg-gradient-to-r from-red-100 to-red-50 border-2 border-red-300{% endif %}">
            <div class="sentiment-emoji mb-4">
              {% if prediction == 'Positive' %}üòä{% else %}üòî{% endif %}
            </div>
            <h3 class="text-4xl font-bold mb-2 {% if prediction == 'Positive' %}text-green-700{% else %}text-red-700{% endif %}">
              {{ prediction }}
            </h3>
            <p class="text-xl text-gray-600">
              Confidence: {{ confidence|floatformat:1 }}%
            </p>
            
            <!-- Confidence Ring -->
            <div class="flex justify-center mt-6">
              <div class="relative w-32 h-32">
                <svg class="w-full h-full transform -rotate-90" viewBox="0 0 36 36">
                  <path class="text-gray-300" stroke="currentColor" stroke-width="3" fill="none"
                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                  <path class="{% if prediction == 'Positive' %}text-green-500{% else %}text-red-500{% endif %} progress-ring" 
                        stroke="currentColor" stroke-width="3" fill="none" stroke-linecap="round"
                        stroke-dasharray="{{ confidence|floatformat:0 }}, 100"
                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                  <span class="text-xl font-bold">{{ confidence|floatformat:0 }}%</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Detailed Probabilities -->
          <div class="space-y-4">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
              <i class="fas fa-percentage mr-2"></i>
              Probability Breakdown
            </h3>
            {% for item in probabilities %}
            <div class="bg-gray-50 rounded-xl p-4">
              <div class="flex justify-between items-center mb-2">
                <span class="font-semibold {% if item.label == 'Positive' %}text-green-700{% else %}text-red-700{% endif %}">
                  {% if item.label == 'Positive' %}üëç {{ item.label }}{% else %}üëé {{ item.label }}{% endif %}
                </span>
                <span class="font-mono text-lg">{{ item.probability|floatformat:1 }}%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                <div class="h-full {% if item.label == 'Positive' %}bg-gradient-to-r from-green-400 to-green-600{% else %}bg-gradient-to-r from-red-400 to-red-600{% endif %} transition-all duration-1000 ease-out" 
                     style="width: {{ item.probability|floatformat:1 }}%"></div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>

      <!-- Side Panel with Charts -->
      <div class="space-y-6">
        <!-- Pie Chart -->
        <div class="glass-card rounded-2xl p-6 shadow-xl">
          <h3 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
            <i class="fas fa-chart-pie mr-2"></i>
            Distribution
          </h3>
          <canvas id="sentimentChart" width="200" height="200"></canvas>
        </div>
        
        <!-- Model Info -->
        <div class="glass-card rounded-2xl p-6 shadow-xl">
          <h3 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
            <i class="fas fa-info-circle mr-2"></i>
            Model Details
          </h3>
          <div class="space-y-2 text-sm text-gray-600">
            <div class="flex justify-between">
              <span>Architecture:</span>
              <span class="font-semibold">DistilBERT</span>
            </div>
            <div class="flex justify-between">
              <span>Parameters:</span>
              <span class="font-semibold">66M</span>
            </div>
            <div class="flex justify-between">
              <span>Accuracy:</span>
              <span class="font-semibold text-green-600">91.2%</span>
            </div>
            <div class="flex justify-between">
              <span>Dataset:</span>
              <span class="font-semibold">IMDB Reviews</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Attention Visualization -->
    {% if attention_html %}
    <div class="glass-card rounded-2xl p-8 shadow-2xl">
      <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
        <i class="fas fa-eye mr-3 text-purple-600"></i>
        Attention Heatmap
      </h2>
      <p class="text-gray-600 mb-6 flex items-center">
        <i class="fas fa-lightbulb mr-2 text-yellow-500"></i>
        This shows which words the AI model focused on when making its decision. Hover over words to see attention scores!
      </p>
      <div class="bg-white p-6 rounded-xl border-2 border-gray-100 text-lg leading-relaxed" id="attentionViz">
        {{ attention_html|safe }}
      </div>
      
      <!-- Attention Legend -->
      <div class="flex justify-center mt-4 space-x-6">
        <div class="flex items-center">
          <div class="w-4 h-4 bg-red-200 rounded mr-2"></div>
          <span class="text-sm text-gray-600">Low Attention</span>
        </div>
        <div class="flex items-center">
          <div class="w-4 h-4 bg-red-500 rounded mr-2"></div>
          <span class="text-sm text-gray-600">High Attention</span>
        </div>
      </div>
    </div>
    {% endif %}
    {% endif %}

    <!-- Feature Cards -->
    <div class="grid md:grid-cols-3 gap-8 mt-12">
      <div class="glass-card rounded-2xl p-6 text-center shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
        <div class="text-4xl mb-4">üéØ</div>
        <h3 class="text-xl font-bold mb-2">Highly Accurate</h3>
        <p class="text-gray-600">91.2% accuracy on IMDB dataset with advanced transformer architecture</p>
      </div>
      
      <div class="glass-card rounded-2xl p-6 text-center shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
        <div class="text-4xl mb-4">‚ö°</div>
        <h3 class="text-xl font-bold mb-2">Lightning Fast</h3>
        <p class="text-gray-600">Real-time analysis with optimized DistilBERT for instant results</p>
      </div>
      
      <div class="glass-card rounded-2xl p-6 text-center shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
        <div class="text-4xl mb-4">üîç</div>
        <h3 class="text-xl font-bold mb-2">Explainable AI</h3>
        <p class="text-gray-600">See exactly which words influenced the model's decision</p>
      </div>
    </div>
  </div>

  <script>
    // Character counter
    const textInput = document.getElementById('textInput');
    const charCount = document.getElementById('charCount');
    
    function updateCharCount() {
      const count = textInput.value.length;
      charCount.textContent = count;
      charCount.className = count > 450 ? 'text-red-500' : count > 400 ? 'text-yellow-500' : 'text-gray-400';
    }
    
    textInput.addEventListener('input', updateCharCount);
    updateCharCount();

    // Example buttons
    document.querySelectorAll('.example-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        textInput.value = btn.dataset.text;
        updateCharCount();
        textInput.focus();
      });
    });

    // Form submission with enhanced loading
    document.getElementById('classifyForm').addEventListener('submit', function() {
      const submitBtn = document.getElementById('submitBtn');
      const btnText = document.getElementById('btnText');
      const btnLoading = document.getElementById('btnLoading');
      
      submitBtn.disabled = true;
      submitBtn.classList.add('opacity-75');
      btnText.classList.add('hidden');
      btnLoading.classList.remove('hidden');
    });

    // Enhanced Chart
    {% if success and probabilities %}
    const ctx = document.getElementById('sentimentChart').getContext('2d');
    const gradient1 = ctx.createLinearGradient(0, 0, 0, 200);
    gradient1.addColorStop(0, '#10b981');
    gradient1.addColorStop(1, '#059669');
    
    const gradient2 = ctx.createLinearGradient(0, 0, 0, 200);
    gradient2.addColorStop(0, '#ef4444');
    gradient2.addColorStop(1, '#dc2626');
    
    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: [{% for item in probabilities %}'{{ item.label }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
        datasets: [{
          data: [{% for item in probabilities %}{{ item.probability|floatformat:1 }}{% if not forloop.last %}, {% endif %}{% endfor %}],
          backgroundColor: [gradient2, gradient1],
          borderWidth: 0,
          hoverBorderWidth: 4,
          hoverBorderColor: '#fff'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        cutout: '60%',
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              usePointStyle: true,
              padding: 20,
              font: { size: 12, weight: '500' }
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.label + ': ' + context.parsed.toFixed(1) + '%';
              }
            }
          }
        },
        animation: {
          animateRotate: true,
          duration: 2000
        }
      }
    });
    
    // Animate attention words
    setTimeout(() => {
      document.querySelectorAll('.attention-word').forEach((word, index) => {
        anime({
          targets: word,
          scale: [0.8, 1],
          opacity: [0, 1],
          delay: index * 50,
          duration: 600,
          easing: 'easeOutQuart'
        });
      });
    }, 500);
    {% endif %}

    // Add typing animation
    anime({
      targets: '.typing-animation',
      opacity: [0, 1],
      translateY: [-20, 0],
      duration: 1000,
      easing: 'easeOutQuart'
    });
  </script>
</body>
</html>